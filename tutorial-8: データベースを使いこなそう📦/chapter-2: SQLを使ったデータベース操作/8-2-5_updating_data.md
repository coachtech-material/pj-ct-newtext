# Tutorial 8-2-5: データの更新（UPDATE）

## 🎯 このセクションで学ぶこと

*   `UPDATE` 文を使って、テーブル内の、既存の、レコードを、更新できるようになる。
*   `SET` 句で、更新する、カラムと、値を、指定する、方法を、理解する。
*   `WHERE` 句で、更新対象の、レコードを、特定する、ことの、重要性を、理解する。
*   `WHERE` 句を、省略した場合の、危険性を、理解する。
*   phpMyAdminの、GUIを、使って、データを、更新する、方法も、知る。

---

## 導入

データベースに、一度、格納した、データも、時間が、経てば、変わることが、あります。ユーザーが、名前を、変更したり、メールアドレスを、変更したり、パスワードを、再設定したり、といった、ケースです。このような、既存の、データを、新しい、情報に、書き換えるために、使われるのが、DML（データ操作言語）の、**`UPDATE`** 文です。

`UPDATE` 文は、非常に、強力な、コマンドですが、一つ、使い方を、間違えると、意図しない、データを、上書きしてしまい、最悪の場合、データベース全体を、破壊しかねない、危険性も、秘めています。

このセクションでは、`UPDATE` 文の、正しい、使い方と、特に、重要な、**`WHERE` 句**の、役割について、重点的に、学んでいきます。

---

## 詳細解説

### 🔄 データを更新する (`UPDATE ... SET ... WHERE ...`)

`UPDATE` 文の、基本的な、構文は、以下の通りです。

```sql
UPDATE table_name
SET column1 = value1, column2 = value2, ...
WHERE condition;
```

*   `UPDATE table_name`: どの、テーブルの、データを、更新するかを、指定します。
*   `SET column1 = value1, ...`: どの、カラムを、どの、値に、変更するかを、指定します。複数の、カラムを、同時に、更新する場合は、カンマで、区切ります。
*   `WHERE condition`: **どの、レコードを、更新するのか**を、特定するための、条件を、指定します。**この `WHERE` 句が、`UPDATE` 文の、心臓部であり、最も、重要な、部分です。**

#### 具体例

それでは、`id` が `1` の、ユーザー（John Doeさん）の、名前を、`Jonathan Doe` に、変更してみましょう。

```sql
UPDATE users
SET name = 'Jonathan Doe'
WHERE id = 1;
```

この、SQL文を、実行すると、`users` テーブルの中から、`id` が `1` の、レコードを、探し出し、その、レコードの、`name` カラムの値だけを、`'Jonathan Doe'` に、更新します。他の、レコード（`id` が 2, 3, ...）には、一切、影響は、ありません。

**phpMyAdminでの実行と確認**

1.  phpMyAdminで、`practice_db` データベースを、選択し、「SQL」タブを、開きます。
2.  上記の、`UPDATE` 文を、実行します。
3.  「表示」タブを、クリックして、`id` が `1` の、ユーザーの、名前が、変わっていることを、確認します。

**[ここに、`id=1` の、ユーザーの、名前が、更新された、テーブル表示の、スクリーンショットを、挿入]**

#### 複数のカラムを同時に更新

`id` が `2` の、ユーザー（Jane Smithさん）の、メールアドレスと、パスワードを、同時に、変更してみましょう。

```sql
UPDATE users
SET
    email = 'jane.s@example.org',
    password = 'new_password_789'
WHERE
    id = 2;
```

`SET` 句に、更新したい、カラムと、値の、ペアを、カンマで、区切って、記述することで、複数の、カラムを、一度に、更新できます。

### ⚠️ `WHERE` 句を忘れるとどうなるか？（絶対にやってはいけない）

もし、`UPDATE` 文で、`WHERE` 句を、書き忘れてしまったら、どうなるでしょうか？

```sql
-- 絶対に、実行しないでください！
UPDATE users
SET password = 'hacked';
```

`WHERE` 句による、条件指定が、ないため、この、SQL文は、**`users` テーブルの、全ての、レコード**に対して、実行されてしまいます。つまり、登録されている、**全ユーザーの、パスワードが、`'hacked'` に、書き換えられてしまう**のです。これは、壊滅的な、データ破壊に、繋がります。

このように、`UPDATE` 文と、後で学ぶ、`DELETE` 文における、`WHERE` 句の、指定は、操作を、安全に、行うための、命綱です。必ず、更新・削除したい、対象の、レコードを、一意に、特定できる、条件（通常は、主キーである、`id` を使います）を、指定する癖を、つけましょう。

### ✍️ GUIでのデータ更新

phpMyAdminでは、GUI操作で、安全に、データを、更新することができます。

1.  `users` テーブルの、「表示」タブを、開きます。
2.  更新したい、レコードの、行にある、「編集」リンク（鉛筆アイコン）を、クリックします。

**[ここに、「編集」リンクを、指し示した、スクリーンショットを、挿入]**

3.  「挿入」画面と、似た、フォームが、表示されるので、更新したい、カラムの、値を、書き換えます。

**[ここに、データ編集フォームの、スクリーンショットを、挿入]**

4.  「実行」ボタンを、クリックします。

この、操作を、行うと、phpMyAdminは、内部的に、`WHERE id = ...` という、`WHERE` 句が、正しく、指定された、`UPDATE` 文を、生成して、実行してくれます。初学者のうちは、GUIでの、更新に、慣れながら、その際に、生成される、SQL文を、確認することで、安全に、`UPDATE` 文の、使い方を、学ぶことができます。

---

## ✨ まとめ

このセクションでは、`UPDATE` 文を、使って、テーブル内の、データを、更新する方法を学びました。

*   テーブルの、データを、更新するには、`UPDATE ... SET ... WHERE ...` 文を、使う。
*   `SET` 句で、更新する、カラムと、新しい、値を、指定する。
*   `WHERE` 句で、更新対象の、レコードを、特定する。**`WHERE` 句は、データ破壊を、防ぐための、命綱であり、絶対に、省略してはならない。**
*   更新対象の、特定には、主キー（`id` など）を使うのが、最も、安全で、確実である。
*   phpMyAdminの、「編集」機能を使えば、GUIで、安全に、データを、更新できる。

データの、作成 (`INSERT`)、取得 (`SELECT`)、更新 (`UPDATE`) が、できるようになりました。最後に、データを、削除するための、`DELETE` 文について、次のセクションで、学んでいきましょう。

---
