# Tutorial 8-1-2: リレーショナルデータベースの概念

## 🎯 このセクションで学ぶこと

*   リレーショナルデータベース（RDB）が、「関係」を、重視する、データベースであることを、理解する。
*   なぜ、Excelのように、1枚の、巨大なシートで、管理しては、いけないのか、その、問題点を、説明できるようになる。
*   「データの、重複」と、「更新の、手間」という、2つの、観点から、テーブルを、分割する、必要性を、理解する。
*   正規化という、言葉の、基本的な、意味を知る。

---

## 導入

前のセクションで、データベースは、「巨大な、高機能な、Excelシート」のようなものだと、学びました。そして、世の中で、最も、広く、使われている、データベースの種類が、**リレーショナルデータベース（Relational Database、略してRDB）**です。

本書で学ぶ、MySQLも、この、RDBの一種です。「リレーショナル」とは、**「関係性のある」**という意味です。つまり、RDBは、**データと、データの、「関係」を、うまく、管理することに、特化した、データベース**なのです。

では、なぜ、わざわざ、「関係」を、管理する必要があるのでしょうか？ Excelのように、1枚の、巨大なシートに、全ての情報を、詰め込んでしまっては、いけないのでしょうか？

このセクションでは、RDBの、最も、重要な、設計思想である、**「テーブルを、適切に、分割し、関係性を持たせる」**という、考え方について、学んでいきます。

---

## 詳細解説

### ❌ 1枚の巨大シートが抱える問題

例えば、ある、オンラインストアの、注文情報を、1枚の、Excelシートで、管理しようとすると、どうなるでしょうか？

**悪い例: 注文管理シート**

| 注文ID | 注文日 | 顧客名 | 顧客メールアドレス | 商品名 | 商品単価 | 数量 | 小計 |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 101 | 2023-10-26 | 山田 太郎 | taro@example.com | りんご | 150 | 3 | 450 |
| 101 | 2023-10-26 | 山田 太郎 | taro@example.com | みかん | 100 | 5 | 500 |
| 102 | 2023-10-27 | 鈴木 花子 | hanako@example.com | ぶどう | 500 | 1 | 500 |
| 103 | 2023-10-28 | 山田 太郎 | taro@example.com | りんご | 150 | 2 | 300 |

一見、分かりやすいように、見えますが、この表には、いくつかの、重大な、問題が、潜んでいます。

#### 問題点1: データの重複（冗長性）

まず、**同じ情報が、何度も、繰り返し、現れている**ことに、気づくでしょうか？

*   注文ID `101` では、「山田 太郎」さんの、顧客情報が、2回、登場しています。
*   商品「りんご」の、単価 `150` 円も、2回、登場しています。

もし、山田さんが、100回、買い物をしたら、その度に、同じ、名前と、メールアドレスが、100回、記録されることになります。これは、データの、無駄遣い（**冗長性**）であり、ディスク容量を、圧迫するだけでなく、後述する、更新の、問題にも、繋がります。

#### 問題点2: 更新の手間と、ミス（更新異常）

次に、もし、山田さんが、メールアドレスを、変更したら、どうなるでしょう？

`taro@example.com` を、`new-taro@example.com` に、変更するには、この表に、登場する、**全ての、「山田 太郎」さんの、行を、見つけ出し、一つずつ、修正**しなければなりません。もし、1行でも、修正を、忘れてしまったら、「古い、メールアドレスの、山田さん」と、「新しい、メールアドレスの、山田さん」という、**データの、不整合**が、発生してしまいます。

また、もし、商品「りんご」が、値上がりして、160円になったら？ やはり、全ての、「りんご」の行を、探し出して、単価を、修正する必要があり、修正漏れのリスクが、常に、つきまといます。これを、**更新異常**と呼びます。

### ✨ テーブルを分割して「関係」でつなぐ

リレーショナルデータベースは、これらの問題を、**テーブルを、意味のある、単位で、分割する**ことで、解決します。

先ほどの、巨大な表は、以下の、3つの、テーブルに、分割するのが、適切です。

**1. 顧客テーブル (`customers`)**

| 顧客ID | 氏名 | メールアドレス |
| :--- | :--- | :--- |
| 1 | 山田 太郎 | taro@example.com |
| 2 | 鈴木 花子 | hanako@example.com |

> **ポイント**: 顧客に関する情報は、ここに、**一意に（重複なく）**、管理されます。

**2. 商品テーブル (`products`)**

| 商品ID | 商品名 | 単価 |
| :--- | :--- | :--- |
| P01 | りんご | 150 |
| P02 | みかん | 100 |
| P03 | ぶどう | 500 |

> **ポイント**: 商品に関する情報も、ここに、**一意に**、管理されます。

**3. 注文テーブル (`orders`)**

| 注文ID | 注文日 | 顧客ID |
| :--- | :--- | :--- |
| 101 | 2023-10-26 | 1 |
| 102 | 2023-10-27 | 2 |
| 103 | 2023-10-28 | 1 |

> **ポイント**: 誰が、いつ、注文したか、という、「**事実**」だけを、記録します。

**4. 注文明細テーブル (`order_details`)**

| 注文明細ID | 注文ID | 商品ID | 数量 |
| :--- | :--- | :--- | :--- |
| 1 | 101 | P01 | 3 |
| 2 | 101 | P02 | 5 |
| 3 | 102 | P03 | 1 |
| 4 | 103 | P01 | 2 |

> **ポイント**: どの注文で、どの商品が、いくつ、売れたか、という、「**注文と商品の、関係**」を、記録します。

#### 分割によるメリット

このように、テーブルを、分割すると、先ほどの問題は、どう、解決されるでしょうか？

*   **データの重複の解消**: 山田さんの、情報は、`customers`テーブルに、1行だけ。りんごの、情報も、`products`テーブルに、1行だけです。データの、重複が、なくなりました。
*   **更新の手間と、ミスの解消**: 山田さんが、メールアドレスを、変更した場合、`customers`テーブルの、**たった1行を、修正するだけ**で、完了します。りんごが、値上がりした場合も、同様に、`products`テーブルの、1行を、修正すれば、OKです。更新異常の、リスクが、劇的に、減少します。

そして、これらの、分割された、テーブルは、「顧客ID」や、「商品ID」といった、**共通の、IDを、介して、「関係」付けられています**。例えば、注文ID `101` の、詳細を、知りたいときは、

1.  `orders`テーブルで、注文ID `101` の、顧客IDが `1` であることを、確認する。
2.  `customers`テーブルで、顧客ID `1` が、「山田 太郎」さんであることを、確認する。
3.  `order_details`テーブルで、注文ID `101` には、商品ID `P01` と `P02` が、含まれていることを、確認する。
4.  `products`テーブルで、商品ID `P01` が「りんご」、`P02` が「みかん」であることを、確認する。

このように、IDを、頼りに、複数の、テーブルを、**結合（JOIN）**することで、元の、巨大な表と、同じ情報を、得ることができるのです。この、**JOIN**こそが、RDBの、真骨頂であり、後のセクションで、詳しく学びます。

このような、データの、重複をなくし、更新の、手間を、減らすために、テーブルを、適切に、分割していく、設計プロセスのことを、**正規化（Normalization）**と呼びます。正規化は、データベース設計の、基本であり、非常に、重要な、概念です。

---

## ✨ まとめ

このセクションでは、リレーショナルデータベースの、中心的な、考え方について学びました。

*   **リレーショナルデータベース（RDB）**は、データ間の、「**関係**」を、管理することに、特化した、データベースである。
*   全ての情報を、1枚の、巨大なシートで、管理すると、「**データの、重複**」と、「**更新の、手間と、ミス（更新異常）**」という、問題が、発生する。
*   RDBでは、この問題を、テーブルを、意味のある、単位（顧客、商品、注文など）に、**分割**することで、解決する。
*   分割された、テーブルは、顧客IDや、商品IDなどの、共通の、IDを、介して、**関係付けられる**。
*   複数の、テーブルを、IDで、結合（**JOIN**）することで、必要な情報を、取り出すことができる。
*   テーブルを、適切に、分割していく、設計プロセスを、**正規化**と呼ぶ。

「**正規化して、テーブルを、分割し、JOINで、つなぎ直す**」。これが、RDBを、使いこなす上での、合言葉です。なぜ、こんな、一見、面倒なことをするのか、その、根本的な、理由を、しっかりと、理解しておきましょう。

---
