# Tutorial 11-1-3: JSONとは

## 🎯 このセクションで学ぶこと

- JSONとは何かを理解する
- JSONの構造と書き方を学ぶ
- PHPでJSONを扱う方法を学ぶ
- APIでJSONを使う理由を理解する

---

## 🧠 先輩エンジニアの思考プロセス

### 「なぜ環境構築の後に『JSON』を学ぶのか？」

環境が整ったら、次は「JSON」です。

---

### 理由1: APIの共通言語

APIでは、データを**JSON形式**でやり取りします。

```json
{
    "id": 1,
    "title": "タスク1",
    "completed": false
}
```

JSONを理解しないと、APIの開発はできません。

---

### 理由2: フロントエンドとの連携

JavaScriptは**JSONをネイティブにサポート**しています。

フロントエンドとバックエンドの連携には、JSONが最適です。

---

### 理由3: LaravelでのJSON操作

Laravelでは、**簡単にJSONレスポンスを返せる**ようになっています。

```php
return response()->json(['message' => 'Hello']);
```

---

### このセクションでやること

| 順番 | 作業 | 理由 |
|------|------|------|
| Step 1 | JSON形式の理解 | 構文と特徴を学ぶ |
| Step 2 | PHPでのJSON操作 | `json_encode()`と`json_decode()` |
| Step 3 | LaravelでのJSON操作 | `response()->json()`の使い方 |

> 💡 **ポイント**: JSONは「JavaScript Object Notation」の略で、軽量なデータ交換形式です。

---

## Step 1: JSONの基礎

### 1-1. JSONとは

**JSON（JavaScript Object Notation）**は、**データを表現するための形式**です。

| 特徴 | 説明 |
|------|------|
| 軽量 | データサイズが小さい |
| 読みやすい | 人間が読みやすい形式 |
| 言語に依存しない | どのプログラミング言語でも扱える |

---

### 1-2. JSONの構造

JSONは、**キーと値のペア**で構成されます。

```json
{
  "name": "田中太郎",
  "age": 30,
  "email": "tanaka@example.com"
}
```

| ルール | 説明 |
|--------|------|
| キー | ダブルクォーテーション（`"`）で囲む |
| 区切り | キーと値はコロン（`:`）で区切る |
| 複数のペア | カンマ（`,`）で区切る |

---

### 1-3. JSONのデータ型

| データ型 | 例 |
|----------|-----|
| 文字列 | `"name": "田中太郎"` |
| 数値 | `"age": 30` |
| 真偽値 | `"is_active": true` |
| null | `"description": null` |
| 配列 | `"tags": ["PHP", "Laravel"]` |
| オブジェクト | `"user": {"name": "田中"}` |

---

### 1-4. JSONの例

**タスクのデータ**:

```json
{
  "id": 1,
  "title": "Laravelを学ぶ",
  "description": "Tutorial 11を完了する",
  "status": "pending",
  "priority": 3,
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z"
}
```

---

### 1-5. 配列を含むJSON

```json
{
  "tasks": [
    {
      "id": 1,
      "title": "Laravelを学ぶ",
      "status": "pending"
    },
    {
      "id": 2,
      "title": "APIを実装する",
      "status": "in_progress"
    }
  ]
}
```

---

### 1-6. ネストしたJSON

```json
{
  "user": {
    "id": 1,
    "name": "田中太郎",
    "tasks": [
      {"id": 1, "title": "Laravelを学ぶ"},
      {"id": 2, "title": "APIを実装する"}
    ]
  }
}
```

---

## Step 2: PHPでJSONを扱う

### 2-1. 配列をJSONに変換

```php
$data = [
    'name' => '田中太郎',
    'age' => 30,
    'email' => 'tanaka@example.com',
];

$json = json_encode($data);
echo $json;
// 出力: {"name":"田中太郎","age":30,"email":"tanaka@example.com"}
```

---

### 2-2. JSONを配列に変換

```php
$json = '{"name":"田中太郎","age":30,"email":"tanaka@example.com"}';

$data = json_decode($json, true);
print_r($data);
// 出力: Array ( [name] => 田中太郎 [age] => 30 [email] => tanaka@example.com )
```

**ポイント**: `json_decode()`の第2引数に`true`を指定すると、連想配列に変換されます。

---

### 2-3. JSONの整形

```php
$data = [
    'name' => '田中太郎',
    'age' => 30,
];

$json = json_encode($data, JSON_PRETTY_PRINT);
echo $json;
```

**出力**:

```json
{
    "name": "田中太郎",
    "age": 30
}
```

---

### 2-4. 日本語を含むJSON

```php
$data = ['name' => '田中太郎'];

// JSON_UNESCAPED_UNICODEなし
echo json_encode($data);
// 出力: {"name":"\u7530\u4e2d\u592a\u90ce"}

// JSON_UNESCAPED_UNICODEあり
echo json_encode($data, JSON_UNESCAPED_UNICODE);
// 出力: {"name":"田中太郎"}
```

---

## Step 3: LaravelでJSONを返す

### 3-1. 基本的な使い方

```php
public function index()
{
    $tasks = Task::all();
    return response()->json($tasks);
}
```

---

### 3-2. 出力例

```json
[
  {
    "id": 1,
    "title": "Laravelを学ぶ",
    "description": "Tutorial 11を完了する",
    "status": "pending",
    "priority": 3,
    "created_at": "2024-01-01T00:00:00.000000Z",
    "updated_at": "2024-01-01T00:00:00.000000Z"
  }
]
```

---

### 3-3. 実践演習

以下のデータをJSON形式で表現してください。

**データ**:

- ユーザー名: 山田花子
- 年齢: 25
- メールアドレス: yamada@example.com
- タスク: ["買い物", "掃除", "料理"]

**解答例**:

```json
{
  "name": "山田花子",
  "age": 25,
  "email": "yamada@example.com",
  "tasks": ["買い物", "掃除", "料理"]
}
```

---

## 🚨 よくある間違い

### 間違い1: キーをシングルクォーテーションで囲む

**問題**: JSONでは、キーは**ダブルクォーテーション**で囲みます。

```json
// ❌ 間違い
{
  'name': '田中太郎'
}

// ✅ 正しい
{
  "name": "田中太郎"
}
```

---

### 間違い2: 最後のカンマ

**問題**: JSONでは、最後のカンマは不要です。

```json
// ❌ 間違い
{
  "name": "田中太郎",
  "age": 30,
}

// ✅ 正しい
{
  "name": "田中太郎",
  "age": 30
}
```

---

### 間違い3: コメントを書く

**問題**: JSONでは、コメントは書けません。

```json
// ❌ 間違い
{
  "name": "田中太郎", // 名前
  "age": 30
}

// ✅ 正しい
{
  "name": "田中太郎",
  "age": 30
}
```

---

## 💡 TIP: JSONの検証ツール

JSONが正しい形式かどうかを確認するには、以下のツールが便利です。

- [JSONLint](https://jsonlint.com/)
- [JSON Formatter](https://jsonformatter.org/)

---

## ✨ まとめ

このセクションでは、JSONについて学びました。

| Step | 学んだこと |
|------|-----------|
| Step 1 | JSONの構造とデータ型 |
| Step 2 | PHPでのJSON操作（encode/decode） |
| Step 3 | LaravelでJSONを返す方法 |

次のセクションでは、API開発ツールについて学びます。

---
