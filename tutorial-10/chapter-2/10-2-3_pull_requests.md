# Tutorial 10-2-3: プルリクエストの作成とレビュー

## 🎯 このセクションで学ぶこと

*   プルリクエストを作成する方法を学ぶ。
*   コードレビューを受ける・行う方法を学ぶ。
*   プルリクエストをマージする方法を学ぶ。

---

## 導入：プルリクエストとは何か？

**プルリクエスト（Pull Request、PR）**とは、**自分のブランチの変更を、別のブランチ（通常は`main`）にマージするためのリクエスト**です。

プルリクエストを使うと、以下のメリットがあります。

*   **コードレビュー**: チームメンバーがコードをレビューできる
*   **議論**: 変更内容について議論できる
*   **品質向上**: レビューを通じて、コードの品質が向上する

---

## 詳細解説

### 🔧 プルリクエストの作成

#### ステップ1: ブランチを作成して開発

```bash
git switch main
git pull origin main
git switch -c feature/1-add-login

# コードを書く
git add .
git commit -m "Add login feature #1"
git push origin feature/1-add-login
```

---

#### ステップ2: GitHubでプルリクエストを作成

1. GitHubリポジトリのページを開く
2. 「Pull requests」タブをクリック
3. 「New pull request」ボタンをクリック
4. **base**: `main`（マージ先）
5. **compare**: `feature/1-add-login`（マージ元）
6. 「Create pull request」ボタンをクリック

---

#### ステップ3: プルリクエストの内容を入力

**タイトル**: ログイン機能の実装 #1

**説明**:

```
## 概要
ログイン機能を実装しました

## 変更内容
- ログインフォームの作成
- ログイン処理の実装
- バリデーションの実装
- テストの作成

## スクリーンショット
（スクリーンショットを添付）

## 確認事項
- [ ] テストが通ることを確認した
- [ ] コードが読みやすいことを確認した
- [ ] ドキュメントを更新した

Closes #1
```

---

#### ステップ4: 「Create pull request」ボタンをクリック

---

### 💡 TIP: プルリクエストテンプレートの作成

プルリクエストテンプレートを作成すると、**プルリクエストの作成時に自動的にテンプレートが表示**されます。

**`.github/PULL_REQUEST_TEMPLATE.md`**

```markdown
## 概要
<!-- プルリクエストの概要を記述してください -->

## 変更内容
<!-- 変更内容を記述してください -->
- 
- 
- 

## スクリーンショット
<!-- スクリーンショットを添付してください -->

## 確認事項
- [ ] テストが通ることを確認した
- [ ] コードが読みやすいことを確認した
- [ ] ドキュメントを更新した

## 関連イシュー
Closes #
```

---

### 🔧 コードレビューの受け方

#### ステップ1: レビュアーを指定

プルリクエストの右側の「Reviewers」をクリックして、レビュアーを指定します。

---

#### ステップ2: レビューを待つ

レビュアーがコードをレビューします。

---

#### ステップ3: フィードバックに対応

レビュアーからフィードバックがあったら、対応します。

**例**:

```
レビュアー: 「この関数は長すぎるので、分割してください」
```

**対応**:

```bash
# コードを修正
git add .
git commit -m "Refactor login function"
git push origin feature/1-add-login
```

プルリクエストに自動的に反映されます。

---

#### ステップ4: レビューが承認されたら、マージ

レビュアーが「Approve」したら、マージできます。

---

### 🔧 コードレビューの行い方

#### ステップ1: プルリクエストを開く

---

#### ステップ2: 「Files changed」タブをクリック

---

#### ステップ3: コードを確認

変更されたコードを確認します。

---

#### ステップ4: コメントを追加

気になる箇所にコメントを追加します。

**例**:

```
この関数は長すぎるので、分割してください
```

---

#### ステップ5: レビューを送信

1. 「Review changes」ボタンをクリック
2. コメントを入力
3. **Comment**: コメントのみ
4. **Approve**: 承認
5. **Request changes**: 変更を要求
6. 「Submit review」ボタンをクリック

---

### 💡 TIP: レビューのポイント

*   **コードの可読性**: コードが読みやすいか
*   **バグの有無**: バグがないか
*   **テストの有無**: テストが書かれているか
*   **パフォーマンス**: パフォーマンスに問題がないか
*   **セキュリティ**: セキュリティに問題がないか

---

### 🚀 実践例1: プルリクエストの作成とレビュー

#### ステップ1: Aさんがプルリクエストを作成

**タイトル**: ログイン機能の実装 #1

**説明**:

```
## 概要
ログイン機能を実装しました

## 変更内容
- ログインフォームの作成
- ログイン処理の実装

Closes #1
```

---

#### ステップ2: Bさんがレビュー

**コメント**:

```
バリデーションが不足しているので、追加してください
```

---

#### ステップ3: Aさんが対応

```bash
# バリデーションを追加
git add .
git commit -m "Add validation"
git push origin feature/1-add-login
```

---

#### ステップ4: Bさんが再レビュー

**コメント**:

```
LGTM（Looks Good To Me）！
```

**レビュー**: Approve

---

#### ステップ5: Aさんがマージ

「Merge pull request」ボタンをクリックします。

---

### 🔧 プルリクエストのマージ

#### マージ方法1: Merge commit

**通常のマージ**。マージコミットが作成されます。

```
main:    A --- B --- M
              \     /
feature:       C ---
```

---

#### マージ方法2: Squash and merge

**すべてのコミットを1つにまとめてマージ**。履歴がシンプルになります。

```
main:    A --- B --- C'
```

---

#### マージ方法3: Rebase and merge

**リベースしてマージ**。履歴が一直線になります。

```
main:    A --- B --- C
```

---

### 💡 TIP: どのマージ方法を選ぶべきか？

*   **Merge commit**: マージの履歴を残したい場合
*   **Squash and merge**: 履歴をシンプルにしたい場合
*   **Rebase and merge**: 履歴を一直線にしたい場合

---

### 🚀 実践例2: Squash and merge

#### ステップ1: プルリクエストを作成

---

#### ステップ2: 「Squash and merge」ボタンをクリック

---

#### ステップ3: コミットメッセージを確認

すべてのコミットが1つにまとめられます。

---

#### ステップ4: 「Confirm squash and merge」ボタンをクリック

---

### 🚨 よくある間違い

#### 間違い1: プルリクエストの説明が不十分

```
# NG
タイトル: 修正
説明: （なし）
```

**対処法**: プルリクエストの説明を詳しく書きます。

```
# OK
タイトル: ログイン機能の実装 #1
説明:
## 概要
ログイン機能を実装しました

## 変更内容
- ログインフォームの作成
- ログイン処理の実装
```

---

#### 間違い2: レビューを待たずにマージ

**対処法**: 必ずレビューを受けてからマージします。

---

#### 間違い3: コンフリクトを解決せずにマージ

**対処法**: コンフリクトを解決してからマージします。

---

### 💡 TIP: プルリクエストのドラフト

開発中のプルリクエストは、**ドラフト（Draft）**として作成できます。

1. 「Create pull request」ボタンの横の「▼」をクリック
2. 「Create draft pull request」を選択

ドラフトのプルリクエストは、**マージできません**。開発が完了したら、「Ready for review」ボタンをクリックします。

---

## ✨ まとめ

このセクションでは、プルリクエストの作成とレビューについて学びました。

*   プルリクエストを作成し、コードレビューを受けられる。
*   コードレビューを行い、フィードバックを送れる。
*   プルリクエストをマージし、変更を統合できる。

次のセクションでは、イシュー駆動でチームメンバー紹介リストを開発する実践演習を行います。

---

## 📝 学習のポイント

- [ ] プルリクエストを作成できる。
- [ ] コードレビューを受ける・行うことができる。
- [ ] プルリクエストをマージできる。
