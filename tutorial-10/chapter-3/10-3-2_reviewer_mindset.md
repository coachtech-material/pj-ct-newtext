# Tutorial 10-3-2: レビュアーとしての心構え

## 🎯 このセクションで学ぶこと

*   レビュアーとしての心構えを学ぶ。
*   建設的なフィードバックの提供方法を理解する。
*   コードレビューのベストプラクティスを学ぶ。

---

## 導入：レビュアーの役割

**レビュアー（Reviewer）**とは、**他の開発者が書いたコードを確認し、フィードバックを提供する人**です。

レビュアーの役割は、**コードを批判すること**ではなく、**コードを改善すること**です。

---

## 詳細解説

### 🔍 レビュアーとしての心構え

#### 心構え1: 建設的なフィードバックを提供する

**批判**ではなく、**改善提案**を行います。

**NG**:

```
このコードはひどい
```

**OK**:

```
この関数は長すぎるので、分割することをお勧めします
```

---

#### 心構え2: 人格ではなく、コードを批判する

**人格**を批判するのではなく、**コード**を批判します。

**NG**:

```
あなたはプログラミングが下手ですね
```

**OK**:

```
この部分は、Eloquentを使った方が可読性が高くなります
```

---

#### 心構え3: ポジティブなフィードバックも忘れない

**改善提案**だけでなく、**良い点**も伝えます。

**例**:

```
この関数は、とても読みやすいですね！
```

---

#### 心構え4: 質問形式で提案する

**命令形**ではなく、**質問形式**で提案します。

**NG**:

```
この部分を修正してください
```

**OK**:

```
この部分は、こうした方が良いと思いますが、いかがでしょうか？
```

---

#### 心構え5: 理由を説明する

**なぜ**その提案をするのか、理由を説明します。

**例**:

```
この関数は長すぎるので、分割することをお勧めします。
理由: 関数が長いと、可読性が低下し、保守性が悪くなるためです。
```

---

### 🚀 実践例1: 建設的なフィードバック

#### シナリオ

Aさんがログイン機能を実装しました。

**コード**:

```php
public function login(Request $request)
{
    $user = User::where('email', $request->email)->first();
    
    if ($user->password === $request->password) {
        Auth::login($user);
        return redirect('/dashboard');
    }
    
    return back()->withErrors(['email' => 'ログインに失敗しました']);
}
```

---

#### NG: 批判的なフィードバック

```
このコードはセキュリティ上の問題があります。修正してください。
```

---

#### OK: 建設的なフィードバック

```
パスワードをハッシュ化せずに比較しているので、セキュリティ上の問題があります。
`Hash::check()`を使うことをお勧めします。

理由: パスワードは平文で保存すべきではなく、ハッシュ化して保存する必要があります。
```

---

### 🚀 実践例2: ポジティブなフィードバック

#### シナリオ

Aさんがユーザー一覧を取得する関数を実装しました。

**コード**:

```php
public function getUsers()
{
    return User::select('id', 'name', 'email')->get();
}
```

---

#### フィードバック

```
Eloquentを使っていて、とても読みやすいコードですね！
必要なカラムだけを取得しているので、パフォーマンスも良いです。
```

---

### 🔍 コードレビューのベストプラクティス

#### ベストプラクティス1: 小さな変更を頻繁にレビューする

**大きな変更**を一度にレビューするのではなく、**小さな変更**を頻繁にレビューします。

*   レビューの負担が軽減される
*   フィードバックが早く得られる
*   バグの早期発見につながる

---

#### ベストプラクティス2: チェックリストを使う

**チェックリスト**を使うと、レビューの漏れを防げます。

**例**:

- [ ] コードが読みやすいか
- [ ] バグがないか
- [ ] テストが書かれているか
- [ ] パフォーマンスに問題がないか
- [ ] セキュリティに問題がないか

---

#### ベストプラクティス3: 自動化できる部分は自動化する

**自動化できる部分**は、ツールに任せます。

*   コードフォーマット: Prettier、PHP CS Fixer
*   静的解析: PHPStan、Psalm
*   テスト: PHPUnit

---

#### ベストプラクティス4: 時間を決めてレビューする

**レビューに時間をかけすぎない**ようにします。

*   1つのプルリクエストに30分〜1時間
*   集中してレビューする
*   疲れたら休憩する

---

#### ベストプラクティス5: 議論はオンラインで行う

**対面**ではなく、**オンライン**で議論します。

*   履歴が残る
*   後から確認できる
*   非同期でコミュニケーションできる

---

### 🚀 実践例3: チェックリストを使ったレビュー

#### シナリオ

Aさんがログイン機能を実装しました。

---

#### チェックリスト

- [ ] コードが読みやすいか → ✅ OK
- [ ] バグがないか → ❌ パスワードのハッシュ化が不足
- [ ] テストが書かれているか → ❌ テストが不足
- [ ] パフォーマンスに問題がないか → ✅ OK
- [ ] セキュリティに問題がないか → ❌ パスワードのハッシュ化が不足

---

#### フィードバック

```
以下の点を修正してください：

1. パスワードのハッシュ化
   - `Hash::check()`を使ってください

2. テストの追加
   - ログイン成功のテスト
   - ログイン失敗のテスト
```

---

### 💡 TIP: LGTM（Looks Good To Me）

レビューが完了し、問題がない場合は、**LGTM**とコメントします。

**LGTM**: Looks Good To Me（私には良く見えます）

---

### 🚨 よくある間違い

#### 間違い1: 批判的なフィードバック

```
# NG
このコードはひどい
```

**対処法**: 建設的なフィードバックを提供します。

```
# OK
この関数は長すぎるので、分割することをお勧めします
```

---

#### 間違い2: 理由を説明しない

```
# NG
この部分を修正してください
```

**対処法**: 理由を説明します。

```
# OK
この部分は、Eloquentを使った方が可読性が高くなります。
理由: 生のSQLよりも、Eloquentの方が読みやすく、保守性が高いためです。
```

---

#### 間違い3: ポジティブなフィードバックを忘れる

**対処法**: 良い点も伝えます。

```
この関数は、とても読みやすいですね！
```

---

### 🔍 レビュアーとしてのスキルアップ

#### スキルアップ1: 他の人のレビューを見る

**他の人のレビュー**を見ることで、レビューのスキルが向上します。

*   どのようなフィードバックをしているか
*   どのような表現を使っているか
*   どのような観点でレビューしているか

---

#### スキルアップ2: フィードバックを受け入れる

**自分のレビュー**に対するフィードバックを受け入れます。

*   レビューの方法を改善できる
*   チームの一体感が生まれる

---

#### スキルアップ3: 継続的に学ぶ

**新しい技術**や**ベストプラクティス**を継続的に学びます。

*   書籍を読む
*   ブログを読む
*   カンファレンスに参加する

---

## ✨ まとめ

このセクションでは、レビュアーとしての心構えについて学びました。

*   建設的なフィードバックを提供し、人格ではなくコードを批判する。
*   ポジティブなフィードバックも忘れず、質問形式で提案する。
*   チェックリストを使い、小さな変更を頻繁にレビューする。

次のセクションでは、レビュイー（レビューを受ける側）としての心構えについて学びます。

---

## 📝 学習のポイント

- [ ] レビュアーとしての心構えを学んだ。
- [ ] 建設的なフィードバックの提供方法を理解した。
- [ ] コードレビューのベストプラクティスを学んだ。
