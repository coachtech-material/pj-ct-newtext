# Tutorial 12-1-3: JSONとは

## 🎯 このセクションで学ぶこと

*   JSONとは何かを理解する。
*   JSONの構造と書き方を学ぶ。
*   PHPでJSONを扱う方法を学ぶ。
*   APIでJSONを使う理由を理解する。

---

## 導入：なぜJSONを使うのか

**JSON（JavaScript Object Notation）**は、**データを表現するための形式**です。

APIでは、**JSON形式でデータをやり取りする**のが一般的です。

---

## 詳細解説

### 🔍 JSONとは

**JSON**は、以下の特徴を持ちます。

*   **軽量**: データサイズが小さい
*   **読みやすい**: 人間が読みやすい形式
*   **言語に依存しない**: どのプログラミング言語でも扱える

---

### 🔍 JSONの構造

JSONは、**キーと値のペア**で構成されます。

```json
{
  "name": "田中太郎",
  "age": 30,
  "email": "tanaka@example.com"
}
```

**ポイント**:
*   キーは、ダブルクォーテーション（`"`）で囲む
*   値は、文字列、数値、真偽値、配列、オブジェクトなど
*   キーと値は、コロン（`:`）で区切る
*   複数のペアは、カンマ（`,`）で区切る

---

### 🔍 JSONのデータ型

JSONでは、以下のデータ型を使えます。

**1. 文字列**

```json
{
  "name": "田中太郎"
}
```

---

**2. 数値**

```json
{
  "age": 30,
  "price": 1000.5
}
```

---

**3. 真偽値**

```json
{
  "is_active": true,
  "is_deleted": false
}
```

---

**4. null**

```json
{
  "description": null
}
```

---

**5. 配列**

```json
{
  "tags": ["PHP", "Laravel", "API"]
}
```

---

**6. オブジェクト**

```json
{
  "user": {
    "name": "田中太郎",
    "age": 30
  }
}
```

---

### 🔍 JSONの例

以下は、タスクのデータをJSON形式で表現した例です。

```json
{
  "id": 1,
  "title": "Laravelを学ぶ",
  "description": "Tutorial 12を完了する",
  "status": "pending",
  "priority": 3,
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z"
}
```

---

### 🔍 配列を含むJSON

複数のタスクを表現する場合は、配列を使います。

```json
{
  "tasks": [
    {
      "id": 1,
      "title": "Laravelを学ぶ",
      "status": "pending"
    },
    {
      "id": 2,
      "title": "APIを実装する",
      "status": "in_progress"
    },
    {
      "id": 3,
      "title": "テストを書く",
      "status": "completed"
    }
  ]
}
```

---

### 🔍 ネストしたJSON

JSONは、ネストできます。

```json
{
  "user": {
    "id": 1,
    "name": "田中太郎",
    "email": "tanaka@example.com",
    "tasks": [
      {
        "id": 1,
        "title": "Laravelを学ぶ"
      },
      {
        "id": 2,
        "title": "APIを実装する"
      }
    ]
  }
}
```

---

### 🔍 PHPでJSONを扱う

PHPでは、`json_encode()`と`json_decode()`を使って、JSONを扱います。

**配列をJSONに変換**:

```php
$data = [
    'name' => '田中太郎',
    'age' => 30,
    'email' => 'tanaka@example.com',
];

$json = json_encode($data);
echo $json;
// 出力: {"name":"田中太郎","age":30,"email":"tanaka@example.com"}
```

---

**JSONを配列に変換**:

```php
$json = '{"name":"田中太郎","age":30,"email":"tanaka@example.com"}';

$data = json_decode($json, true);
print_r($data);
// 出力: Array ( [name] => 田中太郎 [age] => 30 [email] => tanaka@example.com )
```

**ポイント**:
*   `json_decode()`の第2引数に`true`を指定すると、連想配列に変換される
*   `true`を指定しない場合は、オブジェクトに変換される

---

### 🔍 LaravelでJSONを返す

Laravelでは、`response()->json()`を使って、JSON形式でレスポンスを返します。

```php
public function index()
{
    $tasks = Task::all();
    return response()->json($tasks);
}
```

**出力例**:

```json
[
  {
    "id": 1,
    "title": "Laravelを学ぶ",
    "description": "Tutorial 12を完了する",
    "status": "pending",
    "priority": 3,
    "created_at": "2024-01-01T00:00:00.000000Z",
    "updated_at": "2024-01-01T00:00:00.000000Z"
  },
  {
    "id": 2,
    "title": "APIを実装する",
    "description": "RESTful APIを作成する",
    "status": "in_progress",
    "priority": 5,
    "created_at": "2024-01-02T00:00:00.000000Z",
    "updated_at": "2024-01-02T00:00:00.000000Z"
  }
]
```

---

### 🔍 実践演習: JSONを作成してください

以下のデータをJSON形式で表現してください。

**データ**:
*   ユーザー名: 山田花子
*   年齢: 25
*   メールアドレス: yamada@example.com
*   タスク: ["買い物", "掃除", "料理"]

---

**解答例**:

```json
{
  "name": "山田花子",
  "age": 25,
  "email": "yamada@example.com",
  "tasks": ["買い物", "掃除", "料理"]
}
```

---

### 🔍 JSONの整形

JSONは、整形すると読みやすくなります。

**整形前**:

```json
{"name":"田中太郎","age":30,"email":"tanaka@example.com"}
```

**整形後**:

```json
{
  "name": "田中太郎",
  "age": 30,
  "email": "tanaka@example.com"
}
```

PHPでは、`JSON_PRETTY_PRINT`オプションを使って、整形できます。

```php
$data = [
    'name' => '田中太郎',
    'age' => 30,
    'email' => 'tanaka@example.com',
];

$json = json_encode($data, JSON_PRETTY_PRINT);
echo $json;
```

---

### 🔍 日本語を含むJSON

日本語を含むJSONは、`JSON_UNESCAPED_UNICODE`オプションを使います。

```php
$data = [
    'name' => '田中太郎',
];

// JSON_UNESCAPED_UNICODEなし
$json = json_encode($data);
echo $json;
// 出力: {"name":"\u7530\u4e2d\u592a\u90ce"}

// JSON_UNESCAPED_UNICODEあり
$json = json_encode($data, JSON_UNESCAPED_UNICODE);
echo $json;
// 出力: {"name":"田中太郎"}
```

---

### 💡 TIP: JSONの検証ツール

JSONが正しい形式かどうかを確認するには、以下のツールが便利です。

*   [JSONLint](https://jsonlint.com/)
*   [JSON Formatter](https://jsonformatter.org/)

---

### 🚨 よくある間違い

#### 間違い1: キーをシングルクォーテーションで囲む

JSONでは、キーは**ダブルクォーテーション**で囲みます。

```json
// ❌ 間違い
{
  'name': '田中太郎'
}

// ✅ 正しい
{
  "name": "田中太郎"
}
```

---

#### 間違い2: 最後のカンマ

JSONでは、最後のカンマは不要です。

```json
// ❌ 間違い
{
  "name": "田中太郎",
  "age": 30,
}

// ✅ 正しい
{
  "name": "田中太郎",
  "age": 30
}
```

---

#### 間違い3: コメントを書く

JSONでは、コメントは書けません。

```json
// ❌ 間違い
{
  "name": "田中太郎", // 名前
  "age": 30
}

// ✅ 正しい
{
  "name": "田中太郎",
  "age": 30
}
```

---

## ✨ まとめ

このセクションでは、JSONについて学びました。

*   JSONの構造と書き方を理解した。
*   PHPでJSONを扱う方法を学んだ。
*   LaravelでJSONを返す方法を学んだ。

次のセクションでは、API開発環境の準備について学びます。

---

## 📝 学習のポイント

- [ ] JSONの構造を理解した。
- [ ] PHPでJSONを扱った。
- [ ] LaravelでJSONを返した。
- [ ] JSONの整形を行った。
