# Tutorial 12-2-6: DELETE APIã®å®Ÿè£…ï¼ˆå‰Šé™¤ï¼‰

## ğŸ¯ ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å­¦ã¶ã“ã¨

*   ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹DELETE APIã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’å­¦ã¶ã€‚
*   HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ï¼ˆ204 No Contentã€404 Not Foundï¼‰ã‚’ç†è§£ã™ã‚‹ã€‚
*   ãªãœãã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ã†ã®ã‹ã‚’å­¦ã¶ã€‚
*   200 OKã¨204 No Contentã®é•ã„ã‚’ç†è§£ã™ã‚‹ã€‚

---

## å°å…¥ï¼šãªãœ204 No Contentã‚’ä½¿ã†ã®ã‹

ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤ã—ãŸå ´åˆã€**200 OK**ã§ã¯ãªãã€**204 No Content**ã‚’è¿”ã™ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚

*   **200 OK**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæˆåŠŸã—ãŸï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‚ã‚Šï¼‰
*   **204 No Content**: ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæˆåŠŸã—ãŸï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãªã—ï¼‰

**204 No Content**ã‚’ä½¿ã†ã“ã¨ã§ã€**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãŒä¸è¦**ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¢ºã«ä¼ãˆã‚‰ã‚Œã¾ã™ã€‚

---

## è©³ç´°è§£èª¬

### ğŸ” ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹API

ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹APIã‚’å®Ÿè£…ã—ã¾ã™ã€‚

**ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**: `DELETE /api/tasks/{id}`

**ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹ï¼ˆæˆåŠŸæ™‚ï¼‰**:

*   ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰: `204 No Content`
*   ãƒœãƒ‡ã‚£: ãªã—

---

### ğŸ” ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®å®Ÿè£…

**ãƒ•ã‚¡ã‚¤ãƒ«**: `app/Http/Controllers/Api/TaskController.php`

```php
public function destroy($id)
{
    $task = Task::find($id);
    
    if (!$task) {
        return response()->json([
            'message' => 'Task not found'
        ], 404);
    }
    
    $task->delete();
    
    return response()->json(null, 204);
}
```

**ãƒã‚¤ãƒ³ãƒˆ**:
*   `Task::find($id)`ã§ã€ã‚¿ã‚¹ã‚¯ã‚’å–å¾—ã™ã‚‹
*   ã‚¿ã‚¹ã‚¯ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€**404 Not Found**ã‚’è¿”ã™
*   `$task->delete()`ã§ã€ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹
*   **204 No Content**ã‚’è¿”ã™
*   ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã¯`null`

---

### ğŸ” HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰: 204 No Content

**204 No Content**ã¯ã€**ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæˆåŠŸã—ãŸãŒã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãŒãªã„**ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚

**ã„ã¤ä½¿ã†ã‹**:
*   ãƒªã‚½ãƒ¼ã‚¹ãŒæ­£å¸¸ã«å‰Šé™¤ã•ã‚ŒãŸ
*   å‡¦ç†ãŒæ­£å¸¸ã«å®Œäº†ã—ãŸãŒã€è¿”ã™ãƒ‡ãƒ¼ã‚¿ãŒãªã„

**ãªãœ204ã‚’ä½¿ã†ã®ã‹**:
*   ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã€Œå‰Šé™¤ãŒæˆåŠŸã—ãŸã€ã¨åˆ¤æ–­ã§ãã‚‹
*   ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãŒä¸è¦ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¢ºã«ä¼ãˆã‚‰ã‚Œã‚‹
*   å¸¯åŸŸå¹…ã‚’ç¯€ç´„ã§ãã‚‹

**ä¾‹**:

```php
return response()->json(null, 204);
```

ã¾ãŸã¯ã€

```php
return response()->noContent();
```

---

### ğŸ” HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰: 404 Not Found

**404 Not Found**ã¯ã€**ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸ**ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚

**ã„ã¤ä½¿ã†ã‹**:
*   æŒ‡å®šã•ã‚ŒãŸIDã®ãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã—ãªã„

**ãªãœ404ã‚’ä½¿ã†ã®ã‹**:
*   ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã€Œãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã—ãªã„ã€ã¨åˆ¤æ–­ã§ãã‚‹
*   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã§ãã‚‹

**ä¾‹**:

```php
return response()->json([
    'message' => 'Task not found'
], 404);
```

---

### ğŸ” 200 OKã¨204 No Contentã®é•ã„

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ | ç”¨é€” |
|----------------|----------------|------|
| **200 OK** | ã‚ã‚Š | å‰Šé™¤ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ |
| **204 No Content** | ãªã— | å‰Šé™¤ãŒæˆåŠŸã—ãŸã“ã¨ã ã‘ã‚’ä¼ãˆã‚‹ |

**æ¨å¥¨**: DELETEãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã¯ã€**204 No Content**ã‚’ä½¿ã†

---

### ğŸ” 200ã€204ã€404ã®ä½¿ã„åˆ†ã‘

| ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ | çŠ¶æ³ | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ |
|----------------|------|----------------|
| **200 OK** | ã‚¿ã‚¹ã‚¯ãŒå‰Šé™¤ã•ã‚ŒãŸï¼ˆãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™ï¼‰ | å‰Šé™¤ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã®ãƒ‡ãƒ¼ã‚¿ |
| **204 No Content** | ã‚¿ã‚¹ã‚¯ãŒå‰Šé™¤ã•ã‚ŒãŸï¼ˆãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã•ãªã„ï¼‰ | ãªã— |
| **404 Not Found** | ã‚¿ã‚¹ã‚¯ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸ | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |

---

### ğŸ” å®Ÿè·µæ¼”ç¿’: ã‚¿ã‚¹ã‚¯å‰Šé™¤APIã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„

Thunder Clientã§ã€ä»¥ä¸‹ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã¦ãã ã•ã„ã€‚

**1. æˆåŠŸã™ã‚‹å ´åˆ**

*   ãƒ¡ã‚½ãƒƒãƒ‰: `DELETE`
*   URL: `http://localhost:8000/api/tasks/1`

**æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

*   ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰: `204 No Content`
*   ãƒœãƒ‡ã‚£: ãªã—

---

**2. ã‚¿ã‚¹ã‚¯ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ**

*   ãƒ¡ã‚½ãƒƒãƒ‰: `DELETE`
*   URL: `http://localhost:8000/api/tasks/9999`

**æœŸå¾…ã•ã‚Œã‚‹ãƒ¬ã‚¹ãƒãƒ³ã‚¹**:

*   ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰: `404 Not Found`
*   ãƒœãƒ‡ã‚£: `{"message": "Task not found"}`

---

### ğŸ” response()->noContent()ã‚’ä½¿ã†

Laravelã§ã¯ã€`response()->noContent()`ã‚’ä½¿ã†ã¨ã€204 No Contentã‚’è¿”ã›ã¾ã™ã€‚

```php
public function destroy($id)
{
    $task = Task::findOrFail($id);
    $task->delete();
    
    return response()->noContent();
}
```

**ãƒã‚¤ãƒ³ãƒˆ**:
*   `response()->noContent()`ã¯ã€`response()->json(null, 204)`ã¨åŒã˜

---

### ğŸ” å‰Šé™¤ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™å ´åˆ

å‰Šé™¤ã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™å ´åˆã¯ã€**200 OK**ã‚’ä½¿ã„ã¾ã™ã€‚

```php
public function destroy($id)
{
    $task = Task::findOrFail($id);
    $deletedTask = $task->toArray();
    $task->delete();
    
    return response()->json($deletedTask, 200);
}
```

**ãƒã‚¤ãƒ³ãƒˆ**:
*   å‰Šé™¤å‰ã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ãŠã
*   å‰Šé™¤å¾Œã«ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™

---

### ğŸ” ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®é‡è¦æ€§

**é©åˆ‡ãªã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™**ã“ã¨ã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ä»¥ä¸‹ã®ã“ã¨ãŒã§ãã¾ã™ã€‚

*   **æˆåŠŸãƒ»å¤±æ•—ã‚’åˆ¤æ–­ã™ã‚‹**: 204ãªã‚‰å‰Šé™¤æˆåŠŸã€404ãªã‚‰ãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã—ãªã„
*   **ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’è¡Œã†**: 404ã®å ´åˆã¯ã€Œã‚¿ã‚¹ã‚¯ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ã¨è¡¨ç¤º
*   **ãƒªãƒˆãƒ©ã‚¤ã‚’åˆ¤æ–­ã™ã‚‹**: 404ã®å ´åˆã¯ãƒªãƒˆãƒ©ã‚¤ã—ãªã„

---

### ğŸ” ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã®å‡¦ç†ä¾‹ï¼ˆJavaScriptï¼‰

```javascript
fetch('http://localhost:8000/api/tasks/1', {
  method: 'DELETE',
})
  .then(response => {
    if (response.status === 204) {
      console.log('å‰Šé™¤ã•ã‚Œã¾ã—ãŸ');
    } else if (response.status === 404) {
      return response.json().then(data => {
        throw new Error(data.message);
      });
    }
  })
  .catch(error => {
    console.error('ã‚¨ãƒ©ãƒ¼:', error);
  });
```

---

### ğŸ’¡ TIP: ã‚½ãƒ•ãƒˆãƒ‡ãƒªãƒ¼ãƒˆ

**ã‚½ãƒ•ãƒˆãƒ‡ãƒªãƒ¼ãƒˆ**ã‚’ä½¿ã†ã¨ã€ãƒ‡ãƒ¼ã‚¿ã‚’ç‰©ç†çš„ã«å‰Šé™¤ã›ãšã€è«–ç†çš„ã«å‰Šé™¤ã§ãã¾ã™ã€‚

**ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**:

```php
$table->softDeletes();
```

**ãƒ¢ãƒ‡ãƒ«**:

```php
use Illuminate\Database\Eloquent\SoftDeletes;

class Task extends Model
{
    use SoftDeletes;
}
```

**å‰Šé™¤**:

```php
$task->delete(); // deleted_atã«æ—¥æ™‚ãŒè¨­å®šã•ã‚Œã‚‹
```

**å®Œå…¨å‰Šé™¤**:

```php
$task->forceDelete(); // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å®Œå…¨ã«å‰Šé™¤ã•ã‚Œã‚‹
```

---

### ğŸš¨ ã‚ˆãã‚ã‚‹é–“é•ã„

#### é–“é•ã„1: 200 OKã‚’è¿”ã™

å‰Šé™¤ãŒæˆåŠŸã—ãŸå ´åˆã¯ã€**204 No Content**ã‚’è¿”ã™ã®ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚

```php
// âŒ é–“é•ã„ï¼ˆæ¨å¥¨ã•ã‚Œãªã„ï¼‰
return response()->json(['message' => 'Deleted'], 200);

// âœ… æ­£ã—ã„ï¼ˆæ¨å¥¨ï¼‰
return response()->noContent();
```

---

#### é–“é•ã„2: ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‚’è¿”ã™

204 No Contentã®å ´åˆã¯ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‚’è¿”ã—ã¾ã›ã‚“ã€‚

```php
// âŒ é–“é•ã„
return response()->json(['message' => 'Deleted'], 204);

// âœ… æ­£ã—ã„
return response()->json(null, 204);
// ã¾ãŸã¯
return response()->noContent();
```

---

#### é–“é•ã„3: å­˜åœ¨ã—ãªã„ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ã‚ˆã†ã¨ã—ãŸå ´åˆã«200ã‚’è¿”ã™

ã‚¿ã‚¹ã‚¯ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ã€**404 Not Found**ã‚’è¿”ã—ã¾ã™ã€‚

```php
// âŒ é–“é•ã„
public function destroy($id)
{
    $task = Task::find($id);
    
    if (!$task) {
        return response()->json([
            'message' => 'Task not found'
        ], 200); // 200ã¯é–“é•ã„
    }
    
    $task->delete();
    return response()->noContent();
}

// âœ… æ­£ã—ã„
public function destroy($id)
{
    $task = Task::find($id);
    
    if (!$task) {
        return response()->json([
            'message' => 'Task not found'
        ], 404); // 404ãŒæ­£ã—ã„
    }
    
    $task->delete();
    return response()->noContent();
}
```

---

## âœ¨ ã¾ã¨ã‚

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹DELETE APIã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

*   **204 No Content**: ã‚¿ã‚¹ã‚¯ãŒå‰Šé™¤ã•ã‚ŒãŸå ´åˆã«è¿”ã™ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãªã—ï¼‰
*   **404 Not Found**: ã‚¿ã‚¹ã‚¯ãŒè¦‹ã¤ã‹ã‚‰ãªã‹ã£ãŸå ´åˆã«è¿”ã™
*   200 OKã¨204 No Contentã®é•ã„ã‚’ç†è§£ã—ãŸ

æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€è¦ªåˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ä½œæˆã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚

---

## ğŸ“ å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ

- [ ] ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã™ã‚‹APIã‚’å®Ÿè£…ã—ãŸã€‚
- [ ] 204 No Contentã‚’ç†è§£ã—ãŸã€‚
- [ ] 404 Not Foundã‚’ç†è§£ã—ãŸã€‚
- [ ] 200 OKã¨204 No Contentã®é•ã„ã‚’ç†è§£ã—ãŸã€‚
- [ ] response()->noContent()ã‚’ä½¿ã£ãŸã€‚
