""
# Tutorial 8-2-6: データの削除（DELETE）

## 🎯 このセクションで学ぶこと

*   `DELETE` 文を使って、テーブルから、不要な、レコードを、削除できるようになる。
*   `WHERE` 句で、削除対象の、レコードを、特定する、ことの、重要性を、理解する。
*   `WHERE` 句を、省略した場合の、危険性（全件削除）を、理解する。
*   `TRUNCATE TABLE` と `DELETE` の違いを、知る。
*   phpMyAdminの、GUIを、使って、データを、安全に、削除する、方法も、知る。

---

## 導入

データベースを、運用していく中で、不要になった、データを、削除する、必要が、出てきます。例えば、退会した、ユーザーの、情報や、古くなった、お知らせ記事などです。このような、レコードを、テーブルから、取り除くために、使われるのが、DMLの、**`DELETE`** 文です。

`DELETE` 文は、`UPDATE` 文と、同様に、非常に、強力な、コマンドであり、使い方を、間違えると、必要な、データまで、消してしまう、リスクが、あります。特に、`UPDATE` 文と、同じく、**`WHERE` 句**の、正しい、使い方が、極めて、重要になります。

このセクションでは、`DELETE` 文の、安全な、使い方と、関連する、注意点について、学び、CRUD（Create, Read, Update, Delete）の、最後の、一つを、完成させます。

---

## 詳細解説

### 🗑️ データを削除する (`DELETE FROM ... WHERE ...`)

`DELETE` 文の、基本的な、構文は、非常に、シンプルです。

```sql
DELETE FROM table_name
WHERE condition;
```

*   `DELETE FROM table_name`: どの、テーブルから、データを、削除するかを、指定します。
*   `WHERE condition`: **どの、レコードを、削除するのか**を、特定するための、条件を、指定します。`UPDATE` 文と、同様、**この `WHERE` 句が、`DELETE` 文の、命綱です。**

#### 具体例

それでは、`id` が `3` の、ユーザー（Charlieさん）の、レコードを、削除してみましょう。

```sql
DELETE FROM users
WHERE id = 3;
```

この、SQL文を、実行すると、`users` テーブルの中から、`id` が `3` の、レコードを、探し出し、その、行全体を、テーブルから、削除します。他の、レコードには、影響は、ありません。

**phpMyAdminでの実行と確認**

1.  phpMyAdminで、`laravel_db` データベースを、選択し、「SQL」タブを、開きます。
2.  上記の、`DELETE` 文を、実行します。実行前に、確認ダイアログが、表示されることがあります。
3.  「表示」タブを、クリックして、`id` が `3` の、ユーザーの、レコードが、なくなっていることを、確認します。

**[ここに、`id=3` の、レコードが、削除された、テーブル表示の、スクリーンショットを、挿入]**

### ⚠️ `WHERE` 句を忘れるとどうなるか？（絶対にやってはいけない）

`UPDATE` 文の時と、全く、同じです。もし、`DELETE` 文で、`WHERE` 句を、書き忘れてしまったら、どうなるでしょうか？

```sql
-- 絶対に、実行しないでください！
DELETE FROM users;
```

`WHERE` 句による、条件指定が、ないため、この、SQL文は、**`users` テーブルの、全ての、レコード**を、削除してしまいます。テーブルの、構造（カラム定義など）は、残りますが、中身の、データは、空っぽに、なってしまいます。バックアップが、なければ、復旧は、ほぼ、不可能です。

`UPDATE` と `DELETE` を、実行する前には、**必ず `WHERE` 句を、確認する**、という、習慣を、徹底してください。不安な場合は、まず、同じ、`WHERE` 句を、使った、`SELECT` 文を、実行してみて、意図した、レコードだけが、取得されるかを、確認する、という、手順を、踏むのが、プロの、開発者の、やり方です。

```sql
-- DELETEを実行する前に、まずはこちらで確認！
SELECT * FROM users WHERE id = 3;
```

### `TRUNCATE TABLE` との違い

テーブルの、全データを、削除する、方法として、`DELETE FROM table_name;` の他に、`TRUNCATE TABLE table_name;` という、コマンドも、あります。両者の、違いは、少し、専門的になりますが、知っておくと、役立ちます。

| 特徴 | `DELETE FROM table_name;` | `TRUNCATE TABLE table_name;` |
| :--- | :--- | :--- |
| **処理速度** | 遅い（1行ずつ削除） | 速い（テーブルごと再作成） |
| **`WHERE`句** | 使用可能 | 使用不可（常に全件削除） |
| **`AUTO_INCREMENT`** | リセットされない | リセットされる（1から始まる） |
| **トランザクション** | ロールバック可能 | ロールバック不可（基本） |

簡単に、言うと、`DELETE` は、レコードを、一件ずつ、消していく、イメージ、`TRUNCATE` は、テーブルを、一度、空にして、作り直す、イメージです。テストデータなどを、まとめて、リセットしたい、場合には、`TRUNCATE` が、便利ですが、基本的には、より、安全な、`DELETE` を、使うと、覚えておけば、問題ありません。

### ✍️ GUIでのデータ削除

phpMyAdminでは、GUI操作で、安全に、データを、削除することができます。

1.  `users` テーブルの、「表示」タブを、開きます。
2.  削除したい、レコードの、行にある、「削除」リンク（ゴミ箱アイコン）を、クリックします。

**[ここに、「削除」リンクを、指し示した、スクリーンショットを、挿入]**

3.  「本当に、このクエリを、実行しますか？」という、確認ダイアログが、表示されます。ここで、実行される、SQL文（`DELETE FROM `users` WHERE `users`.`id` = ...`）を、確認できます。

**[ここに、削除確認ダイアログの、スクリーンショットを、挿入]**

4.  「OK」を、クリックすると、データが、削除されます。

この、確認ダイアログの、おかげで、誤操作を、防ぐことができます。`UPDATE` の時と、同様に、GUIでの、操作に、慣れながら、裏側で、動いている、SQLを、意識することが、重要です。

---

## ✨ まとめ

このセクションでは、`DELETE` 文を、使って、テーブルから、データを、削除する方法を学びました。

*   テーブルから、データを、削除するには、`DELETE FROM ... WHERE ...` 文を、使う。
*   `WHERE` 句で、削除対象の、レコードを、特定する。**`WHERE` 句は、データ破壊を、防ぐための、命綱であり、絶対に、省略してはならない。**
*   `DELETE` を、実行する前に、同じ、`WHERE` 句で、`SELECT` を、実行し、対象を、確認するのが、安全な、手順である。
*   `TRUNCATE TABLE` は、テーブルの、全データを、高速に、削除するが、`AUTO_INCREMENT` が、リセットされるなど、`DELETE` とは、挙動が、異なる。
*   phpMyAdminの、「削除」機能を使えば、確認ダイアログが、表示され、安全に、データを、削除できる。

これで、データベース操作の、基本である、**CRUD**（Create: `INSERT`, Read: `SELECT`, Update: `UPDATE`, Delete: `DELETE`）の、全てが、揃いました。これらの、4つの、操作が、あらゆる、データベースアプリケーションの、基礎と、なっています。

次のチャプターでは、これまでの、知識を、土台として、データベースの、真の、力である、リレーションシップと、テーブルの、結合について、深く、学んでいきます。

---
